# US-V1-03.1 : Génération carte PDF

| Métadonnée | Valeur |
|------------|--------|
| **ID** | US-V1-03.1 |
| **Epic** | E-V1-03 : Cartes adhérent |
| **Milestone** | V1.0 |
| **Priorité** | P0 |
| **PRD** | [prd-faatere-v1.md](../../prd-faatere-v1.md) |

---

## User Story

**En tant que** gestionnaire,
**Je veux** générer la carte d'un adhérent en PDF,
**Afin qu'** il puisse l'imprimer.

---

## Critères d'acceptance

- [ ] Endpoint GET /members/:id/card/pdf
- [ ] Vérification hasPaid === true (sinon 403)
- [ ] Contenu : nom, prénom, photo, numéro, tomité actuel
- [ ] Design carte format standard
- [ ] QR code optionnel (lien vérification)

---

## Design de la carte

```
┌─────────────────────────────────────────┐
│  FAATERE                    [QR Code]   │
│  Parti Politique de Polynésie           │
├─────────────────────────────────────────┤
│                                         │
│  [Photo]    TETUANUI Moana              │
│             Adhérent n° PPT-2026-00001  │
│             Tomité: Papeete             │
│                                         │
│             Membre depuis: 01/02/2026   │
│                                         │
├─────────────────────────────────────────┤
│  Carte valide pour l'année 2026         │
└─────────────────────────────────────────┘
```

Dimensions : 85.6mm x 53.98mm (format carte bancaire)

---

## Tâches techniques

### Backend

- [ ] Créer endpoint card/pdf
- [ ] Vérifier le statut de paiement
- [ ] Générer le PDF avec pdfkit
- [ ] Inclure la photo redimensionnée
- [ ] Générer QR code avec qrcode library
- [ ] Retourner le fichier PDF

### Frontend

- [ ] Bouton "Générer carte" sur la fiche adhérent
- [ ] Désactiver si non payé
- [ ] Téléchargement automatique

---

## Dépendances

- US-MVP-04.9 : Marquer paiement
- US-MVP-04.10 : Upload photo

---

## Notes

La carte ne peut être générée que si l'adhérent a payé sa cotisation.
