# US-V1-05.1 : Envoi email par tomité

| Métadonnée | Valeur |
|------------|--------|
| **ID** | US-V1-05.1 |
| **Epic** | E-V1-05 : Emails |
| **Milestone** | V1.0 |
| **Priorité** | P1 |
| **PRD** | [prd-faatere-v1.md](../../prd-faatere-v1.md) |

---

## User Story

**En tant que** gestionnaire,
**Je veux** envoyer un email à tous les adhérents de mon tomité,
**Afin de** communiquer avec eux.

---

## Critères d'acceptance

- [ ] Endpoint POST /emails/send
- [ ] Body : tomiteId, subject, body
- [ ] Envoi uniquement aux adhérents avec email
- [ ] File d'attente pour envoi en masse
- [ ] Rapport : envoyés, échecs

---

## Données envoyées

```typescript
interface SendEmailDto {
  tomiteId: string;
  subject: string;
  body: string; // HTML ou plain text
  replyTo?: string;
}

interface SendEmailResult {
  total: number;
  sent: number;
  failed: number;
  failedEmails: string[];
}
```

---

## Tâches techniques

### Backend

- [ ] Créer EmailsModule
- [ ] Créer EmailsService avec méthode send
- [ ] Filtrer les adhérents avec email
- [ ] Implémenter envoi en batch (ex: 50 emails par lot)
- [ ] Gérer les erreurs et retries
- [ ] Retourner le rapport d'envoi

### Frontend

- [ ] Créer page /emails/compose (simplifiée pour tomité)
- [ ] Champs : objet, corps du message
- [ ] Aperçu du nombre de destinataires
- [ ] Afficher le rapport après envoi

---

## Dépendances

- US-MVP-04.4 : Lister les adhérents

---

## Notes

L'envoi en masse doit respecter les limites de l'API Resend pour éviter les blocages.
